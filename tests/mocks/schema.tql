define 

# Shared
id sub attribute, value string;
name sub attribute, value string;
email sub attribute, abstract, value string, regex '^(?=.{1,64}@)[A-Za-z0-9_-]+(\\.[A-Za-z0-9_-]+)*@[^-][A-Za-z0-9-]+(\\.[A-Za-z0-9-]+)*(\\.[A-Za-z]{2,})$';
description sub attribute, value string;


stuff sub attribute, value string;


# User
User·email sub email;
Color·name sub attribute, value string;

# SuperUser
SuperUser·power sub attribute, value string;

# God
God·isEvil sub attribute, value boolean;

# Kind
Kind·name sub attribute, value string;

# Field
Field·cardinality sub attribute, value string;
Field·name sub attribute, value string;

# DataField
DataField·computeType sub attribute, value string;
DataField·type sub attribute, value string;

# Session
Session·expires sub attribute,
    value datetime;
Session·sessionToken sub attribute,
    value string;


Space sub entity,
    owns id @key,
    owns name,
		plays SpaceObj:space,
    plays Space-User:spaces,
    plays UserTagGroup:space;

#Simple Things

Thing sub entity,
    owns id@key,
    owns stuff,
    plays ThingRelation:root,
    plays ThingRelation:things;


SubthingOne sub Thing;
SubthingTwo sub Thing;

ThingRelation sub relation,
    owns id @key,
    relates root,
    relates things;


User sub entity,
    owns id @key,
    owns name,
    owns User·email,
    plays User-Accounts:user,
    plays Space-User:users,
    plays UserTag:users,
    plays User-Sessions:user;

SuperUser sub User,
		owns SuperUser·power;

God sub SuperUser,
		owns God·isEvil;

# Account
Account·provider sub attribute, value string;
Account sub entity,
    owns id @key,
    owns Account·provider,
    plays User-Accounts:accounts;

# Post
Post·mentions sub attribute, value string;
Post sub entity,
  owns id @key,
  owns Post·mentions;

# UserAccounts
User-Accounts sub relation,
    owns id @key,
    relates user,
    relates accounts;

User-Sessions sub relation,
    owns id @key,
    relates sessions,
    relates user;

    # UserAccounts
Space-User sub relation,
    owns id @key,
    relates users,
    relates spaces,
    relates power;

UserTag sub relation,
    owns id @key,
    owns name,
    relates users,
    plays UserTagGroup:tags;

UserTagGroup sub relation,
  owns id @key,
  relates tags, #cardinality: Many
  relates space, #cardinality: One
  relates color;

Color sub entity,
  #owns Color·name @key,
  owns id @key,
  plays UserTagGroup:color;

SpaceObj sub relation,
    owns id,
    relates space;

SpaceDef sub SpaceObj,
    owns description;

Kind sub SpaceDef,
    owns Kind·name,
    plays Field:kinds;

Field sub SpaceDef,
    owns Field·cardinality,
    owns Field·name,
    relates kinds;

DataField sub Field,
    owns DataField·computeType,
    owns DataField·type;

Power sub entity,
    owns id,
    owns description,
    plays Space-User:power;

Self sub SpaceObj,
    relates owner,
    plays Self:owner;

Session sub entity,
    owns Session·sessionToken @key,
    owns id @key,
    owns Session·expires,
    plays User-Sessions:sessions;
    